# å¿«é€Ÿå¼€å§‹

<cite>
**æœ¬æ–‡æ¡£ä¸­å¼•ç”¨çš„æ–‡ä»¶**
- [README.md](file://README.md)
- [DEPLOYMENT.md](file://DEPLOYMENT.md)
- [docker-compose.yml](file://docker-compose.yml)
- [Makefile](file://Makefile)
- [config.yaml](file://config.yaml)
- [tests/data/init-mongo.js](file://tests/data/init-mongo.js)
- [docker/Dockerfile](file://docker/Dockerfile)
- [tests/README.md](file://tests/README.md)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [å‰ç½®è¦æ±‚](#å‰ç½®è¦æ±‚)
3. [Docker Compose éƒ¨ç½²ï¼ˆæ¨èï¼‰](#docker-compose-éƒ¨ç½²æ¨è)
4. [æœ¬åœ°å¼€å‘ç¯å¢ƒ](#æœ¬åœ°å¼€å‘ç¯å¢ƒ)
5. [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
6. [ç«¯åˆ°ç«¯ä½¿ç”¨ç¤ºä¾‹](#ç«¯åˆ°ç«¯ä½¿ç”¨ç¤ºä¾‹)
7. [éªŒè¯æœåŠ¡å¥åº·çŠ¶æ€](#éªŒè¯æœåŠ¡å¥åº·çŠ¶æ€)
8. [å¸¸è§é—®é¢˜æ’æŸ¥](#å¸¸è§é—®é¢˜æ’æŸ¥)
9. [æ€»ç»“](#æ€»ç»“)

## ç®€ä»‹

Mock Server æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ã€çµæ´»å¯é…ç½®çš„ Mock Server ç³»ç»Ÿï¼Œæ”¯æŒå¤šåè®®æ¨¡æ‹Ÿã€å¯è§†åŒ–é…ç½®å’Œä¼ä¸šçº§éƒ¨ç½²ã€‚æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨åœ¨5åˆ†é’Ÿå†…å®Œæˆé¦–æ¬¡ Mock æœåŠ¡è°ƒç”¨ã€‚

### æ ¸å¿ƒç‰¹æ€§
- **å¤šåè®®æ”¯æŒ**ï¼šHTTP/HTTPSã€WebSocketã€ä»£ç†æ¨¡å¼
- **æ™ºèƒ½åŒ¹é…**ï¼šçµæ´»è§„åˆ™åŒ¹é…ã€æ­£åˆ™è¡¨è¾¾å¼ã€è„šæœ¬åŒ–åŒ¹é…
- **åŠ¨æ€å“åº”**ï¼šæ¨¡æ¿å¼•æ“ã€é™æ€é…ç½®ã€æ–‡ä»¶å¼•ç”¨ã€é«˜çº§å»¶è¿Ÿ
- **ä¼ä¸šçº§åŠŸèƒ½**ï¼šé¡¹ç›®ç¯å¢ƒç®¡ç†ã€Webç®¡ç†ç•Œé¢ã€ç»Ÿè®¡åˆ†æã€Dockeréƒ¨ç½²

## å‰ç½®è¦æ±‚

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„ç³»ç»Ÿæ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š

### åŸºç¡€è¦æ±‚
- **Go 1.24+**ï¼ˆç”¨äºæœ¬åœ°å¼€å‘ï¼‰
- **MongoDB 6.0+**ï¼ˆæ•°æ®åº“ï¼‰
- **Docker & Docker Compose**ï¼ˆå¯é€‰ï¼Œæ¨èï¼‰

### ç«¯å£è¦æ±‚
- **8080**: ç®¡ç† API æœåŠ¡
- **9090**: Mock æœåŠ¡ API
- **27017**: MongoDB æ•°æ®åº“

## Docker Compose éƒ¨ç½²ï¼ˆæ¨èï¼‰

è¿™æ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œé€‚åˆå¿«é€Ÿå¼€å§‹å’Œå¼€å‘æµ‹è¯•ç¯å¢ƒã€‚

### ç¬¬ä¸€æ­¥ï¼šå…‹éš†é¡¹ç›®

```bash
# å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°
git clone https://github.com/gomockserver/mockserver.git
cd mockserver
```

### ç¬¬äºŒæ­¥ï¼šå¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆMongoDB + Redis + Mock Serverï¼‰
docker-compose up -d
```

### ç¬¬ä¸‰æ­¥ï¼šéªŒè¯æœåŠ¡

```bash
# æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€
curl http://localhost:8080/api/v1/system/health
```

### åœæ­¢æœåŠ¡

```bash
# åœæ­¢æœåŠ¡ä½†ä¿ç•™æ•°æ®
docker-compose stop

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼ˆä¿ç•™æ•°æ®å·ï¼‰
docker-compose down

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨åŠæ•°æ®å·
docker-compose down -v
```

**ç« èŠ‚æ¥æº**
- [README.md](file://README.md#L42-L54)
- [docker-compose.yml](file://docker-compose.yml#L1-L83)

## æœ¬åœ°å¼€å‘ç¯å¢ƒ

å¦‚æœæ‚¨å¸Œæœ›åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒä¸­è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ã€‚

### æ–¹æ³•ä¸€ï¼šä¸€é”®å¯åŠ¨ï¼ˆæœ€ç®€å•ï¼‰

```bash
# å¯åŠ¨å…¨æ ˆåº”ç”¨ï¼ˆMongoDB + åç«¯ + å‰ç«¯ï¼‰
make start-all

# åœæ­¢æ‰€æœ‰æœåŠ¡
make stop-all
```

**è®¿é—®åœ°å€**ï¼š
- ğŸ¨ **å‰ç«¯ç®¡ç†ç•Œé¢**: http://localhost:5173
- ğŸ”§ **åç«¯ç®¡ç†API**: http://localhost:8080/api/v1
- ğŸš€ **MockæœåŠ¡API**: http://localhost:9090

### æ–¹æ³•äºŒï¼šåˆ†æ­¥å¯åŠ¨

```bash
# 1. å®‰è£…ä¾èµ–
go mod download
cd web && npm install && cd ..

# 2. å¯åŠ¨ MongoDB
make start-mongo

# 3. å¯åŠ¨åç«¯æœåŠ¡
make start-backend

# 4. å¯åŠ¨å‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
make start-frontend
```

### å¸¸ç”¨ Make å‘½ä»¤

```bash
# å¼€å‘ç¯å¢ƒ
make start-all          # å¯åŠ¨å…¨æ ˆåº”ç”¨
make stop-all           # åœæ­¢æœåŠ¡
make test-coverage      # æµ‹è¯•è¦†ç›–ç‡

# Docker
docker-compose up -d    # å¯åŠ¨æœåŠ¡
docker-compose logs -f  # æŸ¥çœ‹æ—¥å¿—

# æœåŠ¡æ£€æŸ¥
curl http://localhost:8080/api/v1/system/health
```

**ç« èŠ‚æ¥æº**
- [README.md](file://README.md#L56-L86)
- [Makefile](file://Makefile#L1-L857)

## é…ç½®è¯´æ˜

### é»˜è®¤é…ç½®æ–‡ä»¶ä½ç½®

- **ä¸»é…ç½®æ–‡ä»¶**: `config.yaml`
- **å¼€å‘é…ç½®**: `config.dev.yaml`
- **æµ‹è¯•é…ç½®**: `config.test.yaml`

### æ ¸å¿ƒé…ç½®é¡¹

```yaml
server:
  admin:
    host: "0.0.0.0"
    port: 8080  # ç®¡ç† API
  mock:
    host: "0.0.0.0"
    port: 9090  # Mock æœåŠ¡

database:
  mongodb:
    uri: "mongodb://localhost:27017"
    database: "mockserver"

logging:
  level: "info"
  format: "json"
```

### ç¯å¢ƒå˜é‡è¦†ç›–

```bash
# è®¾ç½®ç®¡ç†ç«¯å£
export SERVER_ADMIN_PORT=8080

# è®¾ç½® Mock ç«¯å£
export SERVER_MOCK_PORT=9090

# è®¾ç½® MongoDB URI
export DATABASE_MONGODB_URI="mongodb://localhost:27017"

# è®¾ç½®æ—¥å¿—çº§åˆ«
export LOGGING_LEVEL="debug"
```

**ç« èŠ‚æ¥æº**
- [config.yaml](file://config.yaml#L1-L91)
- [DEPLOYMENT.md](file://DEPLOYMENT.md#L552-L647)

## ç«¯åˆ°ç«¯ä½¿ç”¨ç¤ºä¾‹

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ Mock æœåŠ¡ç¤ºä¾‹ï¼Œå±•ç¤ºä»é¡¹ç›®åˆ›å»ºåˆ°æ¥å£æµ‹è¯•çš„å…¨è¿‡ç¨‹ã€‚

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé¡¹ç›®

```bash
# åˆ›å»ºæµ‹è¯•é¡¹ç›®
curl -X POST http://localhost:8080/api/v1/projects \
  -H "Content-Type: application/json" \
  -d '{"name": "æµ‹è¯•é¡¹ç›®", "workspace_id": "default"}'
```

**è¿”å›ç¤ºä¾‹**ï¼š
```json
{
  "id": "PROJECT_ID",
  "name": "æµ‹è¯•é¡¹ç›®",
  "workspace_id": "default",
  "created_at": "2024-01-01T00:00:00Z"
}
```

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºç¯å¢ƒ

```bash
# åˆ›å»ºå¼€å‘ç¯å¢ƒ
curl -X POST http://localhost:8080/api/v1/environments \
  -H "Content-Type: application/json" \
  -d '{
    "name": "å¼€å‘ç¯å¢ƒ",
    "project_id": "PROJECT_ID",
    "description": "å¼€å‘æµ‹è¯•ç¯å¢ƒ"
  }'
```

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºMockè§„åˆ™

```bash
# åˆ›å»ºç”¨æˆ·åˆ—è¡¨æ¥å£çš„Mockè§„åˆ™
curl -X POST http://localhost:8080/api/v1/rules \
  -H "Content-Type: application/json" \
  -d '{
    "name": "ç”¨æˆ·åˆ—è¡¨æ¥å£",
    "project_id": "PROJECT_ID",
    "environment_id": "ENV_ID",
    "protocol": "HTTP",
    "match_type": "Simple",
    "match_condition": {
      "method": "GET",
      "path": "/api/users"
    },
    "response": {
      "type": "Static",
      "content": {
        "status_code": 200,
        "content_type": "JSON",
        "body": {"code": 0, "data": [{"id": 1, "name": "å¼ ä¸‰"}]}
      }
    }
  }'
```

### ç¬¬å››æ­¥ï¼šæµ‹è¯•Mockæ¥å£

```bash
# æµ‹è¯•Mockæ¥å£
curl http://localhost:9090/PROJECT_ID/ENV_ID/api/users
```

**é¢„æœŸå“åº”**ï¼š
```json
{
  "code": 0,
  "data": [
    {
      "id": 1,
      "name": "å¼ ä¸‰"
    }
  ]
}
```

### ç¬¬äº”æ­¥ï¼šé€šè¿‡Webç•Œé¢ç®¡ç†

1. è®¿é—® **http://localhost:5173**
2. ä½¿ç”¨å¯è§†åŒ–ç•Œé¢ç®¡ç†é¡¹ç›®ã€ç¯å¢ƒå’ŒMockè§„åˆ™
3. å®æ—¶ç›‘æ§è¯·æ±‚æ—¥å¿—å’Œæ€§èƒ½æŒ‡æ ‡

**ç« èŠ‚æ¥æº**
- [README.md](file://README.md#L92-L124)

## éªŒè¯æœåŠ¡å¥åº·çŠ¶æ€

### å¥åº·æ£€æŸ¥ç«¯ç‚¹

```bash
# æ£€æŸ¥ç®¡ç†APIæœåŠ¡
curl http://localhost:8080/api/v1/system/health

# æ£€æŸ¥MockæœåŠ¡
curl http://localhost:9090/health

# è·å–ç‰ˆæœ¬ä¿¡æ¯
curl http://localhost:8080/api/v1/system/version
```

### å¥åº·æ£€æŸ¥å“åº”æ ¼å¼

```json
{
  "status": "healthy",
  "timestamp": "2024-01-01T00:00:00Z",
  "version": "v0.7.0",
  "uptime": "1h23m45s"
}
```

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹DockeræœåŠ¡æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹æœ¬åœ°æœåŠ¡æ—¥å¿—
tail -f logs/mockserver.log
```

**ç« èŠ‚æ¥æº**
- [README.md](file://README.md#L180-L182)
- [DEPLOYMENT.md](file://DEPLOYMENT.md#L653-L664)

## å¸¸è§é—®é¢˜æ’æŸ¥

### æœåŠ¡å¯åŠ¨å¤±è´¥

**ç—‡çŠ¶**: æœåŠ¡å¯åŠ¨åç«‹å³é€€å‡ºæˆ–æ— æ³•è¿æ¥

**æ’æŸ¥æ­¥éª¤**:
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs mockserver

# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :8080
lsof -i :9090

# æ£€æŸ¥é…ç½®æ–‡ä»¶
cat config.yaml
```

### MongoDBè¿æ¥é—®é¢˜

**ç—‡çŠ¶**: æ—¥å¿—æ˜¾ç¤ºæ•°æ®åº“è¿æ¥é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥MongoDBæœåŠ¡çŠ¶æ€
docker-compose ps mongodb

# æ£€æŸ¥ç½‘ç»œè¿æ¥
docker network ls
docker network inspect mockserver_mockserver-network

# æµ‹è¯•MongoDBè¿æ¥
docker exec -it mockserver-mongodb mongosh
```

### Mockè§„åˆ™ä¸ç”Ÿæ•ˆ

**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥è§„åˆ™æ˜¯å¦å¯ç”¨ (`enabled: true`)
2. ç¡®è®¤ `project_id` å’Œ `environment_id` æ­£ç¡®
3. æ£€æŸ¥è§„åˆ™ä¼˜å…ˆçº§å’ŒåŒ¹é…æ¡ä»¶
4. æŸ¥çœ‹è¯·æ±‚æ—¥å¿—

### æ€§èƒ½é—®é¢˜

**ä¼˜åŒ–å»ºè®®**:
- å¯ç”¨Redisç¼“å­˜
- å¢åŠ MongoDBè¿æ¥æ± å¤§å°
- è°ƒæ•´æ—¥å¿—çº§åˆ«ä¸º `warn` æˆ– `error`
- ä½¿ç”¨SSDå­˜å‚¨
- å¢åŠ æœåŠ¡å™¨èµ„æº

**ç« èŠ‚æ¥æº**
- [DEPLOYMENT.md](file://DEPLOYMENT.md#L708-L768)

## æ€»ç»“

é€šè¿‡æœ¬æŒ‡å—ï¼Œæ‚¨å·²ç»å­¦ä¼šäº†ï¼š

1. **å¿«é€Ÿéƒ¨ç½²**: ä½¿ç”¨Docker Composeæˆ–æœ¬åœ°å¼€å‘ç¯å¢ƒå¯åŠ¨Mock Server
2. **åŸºæœ¬é…ç½®**: ç†è§£æ ¸å¿ƒé…ç½®æ–‡ä»¶å’Œç¯å¢ƒå˜é‡
3. **ç«¯åˆ°ç«¯ä½¿ç”¨**: åˆ›å»ºé¡¹ç›®ã€ç¯å¢ƒå’ŒMockè§„åˆ™
4. **æœåŠ¡éªŒè¯**: æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡
5. **é—®é¢˜æ’æŸ¥**: å¸¸è§é—®é¢˜çš„è¯Šæ–­å’Œè§£å†³æ–¹æ³•

### ä¸‹ä¸€æ­¥å»ºè®®

- æ¢ç´¢Webç®¡ç†ç•Œé¢çš„é«˜çº§åŠŸèƒ½
- å­¦ä¹ å¤æ‚åŒ¹é…è§„åˆ™çš„é…ç½®
- äº†è§£WebSocket Mockçš„å®ç°
- é…ç½®Redisç¼“å­˜æå‡æ€§èƒ½
- éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

### è·å–å¸®åŠ©

- æŸ¥çœ‹å®Œæ•´æ–‡æ¡£: [README.md](file://README.md)
- æäº¤Issue: [GitHub Issues](https://github.com/gomockserver/mockserver/issues)
- æŸ¥çœ‹éƒ¨ç½²æŒ‡å—: [DEPLOYMENT.md](file://DEPLOYMENT.md)

Mock Serverè®©API Mockå˜å¾—ç®€å•è€Œå¼ºå¤§ï¼Œç¥æ‚¨å¼€å‘æ„‰å¿«ï¼