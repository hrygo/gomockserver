# Mock Server ä¸‹ä¸€æ­¥å·¥ä½œä»»åŠ¡è·¯çº¿å›¾

**ç”Ÿæˆæ—¶é—´**: 2025-11-14  
**å½“å‰çŠ¶æ€**: âœ… MVP ç‰ˆæœ¬å•å…ƒæµ‹è¯•å®Œæˆï¼Œæ€»ä½“è¦†ç›–ç‡ 48.2%  
**æµ‹è¯•ç»“æœ**: 229 ä¸ªæµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡ âœ…

---

## ğŸ“Š å½“å‰æµ‹è¯•çŠ¶å†µæ€»è§ˆ

### æµ‹è¯•è¦†ç›–ç‡ç°çŠ¶

| æ¨¡å— | è¦†ç›–ç‡ | çŠ¶æ€ | ä¼˜å…ˆçº§ |
|------|-------|------|--------|
| **adapter** | 96.3% | âœ… ä¼˜ç§€ | - |
| **api** | 89.5% | âœ… è‰¯å¥½ | ä½ |
| **engine** | 58.0% | âš ï¸ éœ€æ”¹è¿› | **é«˜** |
| **executor** | 71.9% | âš ï¸ å¯ä¼˜åŒ– | **ä¸­** |
| **repository** | 0.0% (å®é™…é›†æˆæµ‹è¯• 52.6%) | âš ï¸ å•å…ƒæµ‹è¯•ç¼ºå¤± | ä¸­ |
| **service** | 45.6% | âš ï¸ éœ€æ”¹è¿› | ä¸­ |
| **config** | 0.0% | âŒ æœªæµ‹è¯• | **é«˜** |
| **models** | 0.0% (æ•°æ®æ¨¡å‹) | â„¹ï¸ ä¸éœ€è¦ | - |
| **æ€»ä½“** | **48.2%** | âš ï¸ éœ€æå‡åˆ° 60%+ | - |

### æµ‹è¯•æ–‡ä»¶åˆ†å¸ƒ

- âœ… **adapter**: 2 æºæ–‡ä»¶, 1 æµ‹è¯•æ–‡ä»¶
- âœ… **api**: 2 æºæ–‡ä»¶, 2 æµ‹è¯•æ–‡ä»¶  
- âŒ **config**: 1 æºæ–‡ä»¶, æ— æµ‹è¯•æ–‡ä»¶
- âœ… **engine**: 1 æºæ–‡ä»¶, 1 æµ‹è¯•æ–‡ä»¶
- âœ… **executor**: 1 æºæ–‡ä»¶, 1 æµ‹è¯•æ–‡ä»¶
- â„¹ï¸ **models**: 1 æºæ–‡ä»¶, æ— æµ‹è¯•æ–‡ä»¶ï¼ˆæ•°æ®æ¨¡å‹æ— éœ€æµ‹è¯•ï¼‰
- âœ… **repository**: 3 æºæ–‡ä»¶, 2 æµ‹è¯•æ–‡ä»¶
- âœ… **service**: 2 æºæ–‡ä»¶, 2 æµ‹è¯•æ–‡ä»¶

---

## ğŸ¯ ä¸‹ä¸€æ­¥å·¥ä½œä»»åŠ¡æ¸…å•

### é˜¶æ®µä¸€ï¼šæå‡å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ ğŸ”´ï¼‰

**ç›®æ ‡**: å°†æ€»ä½“è¦†ç›–ç‡ä» 48.2% æå‡åˆ° 60%+

#### ä»»åŠ¡ 1: æå‡ Engine æ¨¡å—æµ‹è¯•è¦†ç›–ç‡ ğŸ”´

**å½“å‰çŠ¶æ€**: 58.0% â†’ **ç›®æ ‡**: 80%+  
**ä¼˜å…ˆçº§**: é«˜  
**é¢„è®¡æ—¶é—´**: 0.5 å¤©

**å¾…è¡¥å……æµ‹è¯•åœºæ™¯**:

1. **IP ç™½åå•åŒ¹é…æµ‹è¯•**
   - IP åœ¨ç™½åå•å†…åŒ¹é…æˆåŠŸ
   - IP ä¸åœ¨ç™½åå•å†…åŒ¹é…å¤±è´¥
   - CIDR èŒƒå›´åŒ¹é…ï¼ˆå¦‚ 192.168.1.0/24ï¼‰
   - å¤šä¸ª IP ç™½åå•è§„åˆ™

2. **å¤æ‚æ¡ä»¶ç»„åˆæµ‹è¯•**
   - Method + Path + Query + Header å…¨éƒ¨åŒ¹é…
   - éƒ¨åˆ†æ¡ä»¶åŒ¹é…ï¼Œéƒ¨åˆ†ä¸åŒ¹é…
   - å¤šä¸ª Query å‚æ•°åŒæ—¶åŒ¹é…
   - å¤šä¸ª Header åŒæ—¶åŒ¹é…

3. **è¾¹ç•Œåœºæ™¯æµ‹è¯•**
   - ç©ºè§„åˆ™åˆ—è¡¨
   - æ‰€æœ‰è§„åˆ™éƒ½è¢«ç¦ç”¨
   - åè®®ç±»å‹ä¸åŒ¹é…
   - ä¼˜å…ˆçº§ç›¸åŒæ—¶çš„æ’åºé€»è¾‘

4. **å½“å‰æœªè¦†ç›–çš„å‡½æ•°**
   - `NewMatchEngine` (line 22)
   - `Match` ä¸»æµç¨‹ (line 29)
   - `matchHTTP` ä¸­çš„ IP é™åˆ¶é€»è¾‘ (line 139, 145)
   - `matchPath` è·¯å¾„å‚æ•°æå– (line 229)

**æ‰§è¡Œå‘½ä»¤**:
```bash
# æŸ¥çœ‹å½“å‰è¦†ç›–æƒ…å†µ
go tool cover -func=docs/testing/coverage/unit-coverage-engine.out

# è¿è¡Œ Engine æ¨¡å—æµ‹è¯•
go test -v ./internal/engine -coverprofile=coverage.out
```

---

#### ä»»åŠ¡ 2: æå‡ Executor æ¨¡å—æµ‹è¯•è¦†ç›–ç‡ ğŸŸ¡

**å½“å‰çŠ¶æ€**: 71.9% â†’ **ç›®æ ‡**: 85%+  
**ä¼˜å…ˆçº§**: ä¸­  
**é¢„è®¡æ—¶é—´**: 0.5 å¤©

**å¾…è¡¥å……æµ‹è¯•åœºæ™¯**:

1. **å“åº”å†…å®¹ç±»å‹æµ‹è¯•**
   - XML æ ¼å¼å“åº”ç”Ÿæˆ
   - HTML æ ¼å¼å“åº”ç”Ÿæˆ
   - çº¯æ–‡æœ¬å“åº”ç”Ÿæˆ
   - ç©ºå“åº”ä½“å¤„ç†

2. **å»¶è¿Ÿé…ç½®æµ‹è¯•**
   - éšæœºå»¶è¿ŸèŒƒå›´éªŒè¯
   - å»¶è¿Ÿä¸º 0 çš„æƒ…å†µ
   - è´Ÿæ•°å»¶è¿Ÿå¤„ç†

3. **é”™è¯¯å¤„ç†åœºæ™¯**
   - ä¸æ”¯æŒçš„å“åº”ç±»å‹
   - å“åº”ä½“åºåˆ—åŒ–å¤±è´¥
   - è¶…å¤§å“åº”ä½“å¤„ç†

4. **å½“å‰æœªè¦†ç›–çš„å‡½æ•°**
   - `staticResponse` ä¸­çš„ç‰¹æ®Šå†…å®¹ç±»å‹å¤„ç† (line 52)
   - `calculateDelay` éšæœºå»¶è¿Ÿé€»è¾‘ (line 117)

**æ‰§è¡Œå‘½ä»¤**:
```bash
go tool cover -func=docs/testing/coverage/unit-coverage-executor.out
go test -v ./internal/executor -coverprofile=coverage.out
```

---

#### ä»»åŠ¡ 3: æ·»åŠ  Config æ¨¡å—å•å…ƒæµ‹è¯• ğŸ”´

**å½“å‰çŠ¶æ€**: 0% â†’ **ç›®æ ‡**: 70%+  
**ä¼˜å…ˆçº§**: é«˜  
**é¢„è®¡æ—¶é—´**: 0.5 å¤©

**éœ€è¦æµ‹è¯•çš„åŠŸèƒ½**:

1. **é…ç½®æ–‡ä»¶åŠ è½½**
   - ä» YAML æ–‡ä»¶åŠ è½½é…ç½®
   - é…ç½®æ–‡ä»¶ä¸å­˜åœ¨æ—¶çš„é»˜è®¤å€¼
   - é…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯å¤„ç†

2. **é…ç½®éªŒè¯**
   - å¿…å¡«å­—æ®µéªŒè¯
   - ç«¯å£èŒƒå›´éªŒè¯
   - æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²éªŒè¯

3. **ç¯å¢ƒå˜é‡è¦†ç›–**
   - ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§
   - ç¯å¢ƒå˜é‡æ ¼å¼è½¬æ¢

4. **é»˜è®¤å€¼å¤„ç†**
   - å„é…ç½®é¡¹çš„é»˜è®¤å€¼
   - éƒ¨åˆ†é…ç½®ç¼ºå¤±æ—¶çš„è¡Œä¸º

**åˆ›å»ºæ–‡ä»¶**: `internal/config/config_test.go`

**ç¤ºä¾‹æµ‹è¯•**:
```go
func TestLoadConfig(t *testing.T) {
    // æµ‹è¯•ä»æ–‡ä»¶åŠ è½½
    // æµ‹è¯•ç¯å¢ƒå˜é‡è¦†ç›–
    // æµ‹è¯•é»˜è®¤å€¼
}

func TestValidateConfig(t *testing.T) {
    // æµ‹è¯•å„ç§éæ³•é…ç½®
}
```

---

### é˜¶æ®µäºŒï¼šé›†æˆæµ‹è¯•å’Œç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ ğŸŸ¡ï¼‰

#### ä»»åŠ¡ 4: åˆ›å»ºç«¯åˆ°ç«¯é›†æˆæµ‹è¯•å¥—ä»¶ ğŸŸ¡

**ä¼˜å…ˆçº§**: ä¸­  
**é¢„è®¡æ—¶é—´**: 1 å¤©

**æµ‹è¯•åœºæ™¯**:

1. **å®Œæ•´ä¸šåŠ¡æµç¨‹æµ‹è¯•**
   - åˆ›å»ºé¡¹ç›®
   - åˆ›å»ºç¯å¢ƒ
   - åˆ›å»ºå¤šæ¡ Mock è§„åˆ™
   - å‘é€ Mock è¯·æ±‚éªŒè¯
   - æ›´æ–°è§„åˆ™å¹¶éªŒè¯å˜åŒ–
   - ç¦ç”¨/å¯ç”¨è§„åˆ™éªŒè¯
   - åˆ é™¤è§„åˆ™å’Œé¡¹ç›®

2. **å¤šç¯å¢ƒéš”ç¦»æµ‹è¯•**
   - åŒä¸€é¡¹ç›®çš„ä¸åŒç¯å¢ƒ
   - ä¸åŒé¡¹ç›®çš„è§„åˆ™éš”ç¦»
   - è·¨ç¯å¢ƒè¯·æ±‚éªŒè¯å¤±è´¥

3. **è§„åˆ™ä¼˜å…ˆçº§æµ‹è¯•**
   - é«˜ä¼˜å…ˆçº§è§„åˆ™ä¼˜å…ˆåŒ¹é…
   - ç¦ç”¨é«˜ä¼˜å…ˆçº§åä½ä¼˜å…ˆçº§ç”Ÿæ•ˆ

**åˆ›å»ºæ–‡ä»¶**: `tests/e2e/e2e_test.go`

**æµ‹è¯•æ¶æ„**:
```go
func TestE2E_UserServiceMockFlow(t *testing.T) {
    // 1. å¯åŠ¨ Mock Server
    // 2. åˆ›å»ºé¡¹ç›®å’Œç¯å¢ƒ
    // 3. åˆ›å»ºè§„åˆ™
    // 4. å‘é€è¯·æ±‚éªŒè¯
    // 5. æ¸…ç†æ•°æ®
}
```

**æ‰§è¡Œæ–¹å¼**:
```bash
# å¯åŠ¨æµ‹è¯•ç¯å¢ƒ
docker-compose -f docker-compose.test.yml up -d

# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
go test -v ./tests/e2e/...

# æ¸…ç†æµ‹è¯•ç¯å¢ƒ
docker-compose -f docker-compose.test.yml down
```

---

#### ä»»åŠ¡ 5: å®æ–½æ€§èƒ½æµ‹è¯• ğŸŸ¡

**ä¼˜å…ˆçº§**: ä¸­  
**é¢„è®¡æ—¶é—´**: 0.5 å¤©

**æ€§èƒ½ç›®æ ‡**:

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | æµ‹è¯•å·¥å…· |
|------|--------|---------|
| QPS | > 10,000 | wrk / JMeter |
| å¹³å‡å“åº”æ—¶é—´ | < 10ms | wrk |
| P95 å“åº”æ—¶é—´ | < 30ms | wrk |
| P99 å“åº”æ—¶é—´ | < 50ms | wrk |
| å¹¶å‘è¿æ¥æ•° | > 5,000 | wrk |

**æµ‹è¯•åœºæ™¯**:

1. **åŸºå‡†æ€§èƒ½æµ‹è¯•**
   - å•ä¸ªç®€å•è§„åˆ™çš„æ€§èƒ½
   - 10 æ¡è§„åˆ™çš„åŒ¹é…æ€§èƒ½
   - 100 æ¡è§„åˆ™çš„åŒ¹é…æ€§èƒ½

2. **å‹åŠ›æµ‹è¯•**
   - é€æ­¥å¢åŠ å¹¶å‘ç”¨æˆ·ï¼ˆ100 â†’ 5,000ï¼‰
   - é•¿æ—¶é—´ç¨³å®šæ€§æµ‹è¯•ï¼ˆ1å°æ—¶ï¼‰
   - å“åº”å»¶è¿Ÿé…ç½®ä¸‹çš„æ€§èƒ½

3. **èµ„æºç›‘æ§**
   - CPU ä½¿ç”¨ç‡
   - å†…å­˜ä½¿ç”¨é‡
   - Goroutine æ•°é‡
   - æ•°æ®åº“è¿æ¥æ•°

**å·¥å…·å’Œè„šæœ¬**:

```bash
# ä½¿ç”¨ wrk è¿›è¡Œæ€§èƒ½æµ‹è¯•
wrk -t12 -c400 -d30s http://localhost:9090/project-id/env-id/api/users

# ä½¿ç”¨ Go benchmark
go test -bench=. -benchmem ./internal/engine/
```

**åˆ›å»ºæ–‡ä»¶**: 
- `tests/performance/benchmark_test.go`
- `tests/performance/wrk_scripts/mock_request.lua`

---

### é˜¶æ®µä¸‰ï¼šå¯é æ€§å’Œå¼‚å¸¸æµ‹è¯•ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ ğŸŸ¡ï¼‰

#### ä»»åŠ¡ 6: å¼‚å¸¸åœºæ™¯å’Œå¯é æ€§æµ‹è¯• ğŸŸ¡

**ä¼˜å…ˆçº§**: ä¸­  
**é¢„è®¡æ—¶é—´**: 1 å¤©

**æµ‹è¯•åœºæ™¯**:

1. **æ•°æ®åº“æ•…éšœåœºæ™¯**
   - MongoDB è¿æ¥å¤±è´¥
   - æŸ¥è¯¢è¶…æ—¶
   - å†™å…¥å¤±è´¥
   - è¿æ¥æ± è€—å°½
   - æœåŠ¡é‡å¯åæ¢å¤

2. **éæ³•è¯·æ±‚å¤„ç†**
   - ç•¸å½¢ HTTP è¯·æ±‚
   - è¶…å¤§è¯·æ±‚ä½“ï¼ˆ> 10MBï¼‰
   - éæ³• JSON æ ¼å¼
   - ç¼ºå°‘å¿…éœ€å‚æ•°
   - SQL æ³¨å…¥å°è¯•

3. **å¹¶å‘åœºæ™¯**
   - åŒæ—¶åˆ›å»ºåŒåé¡¹ç›®
   - åŒæ—¶æ›´æ–°åŒä¸€è§„åˆ™
   - é«˜å¹¶å‘æŸ¥è¯¢è§„åˆ™
   - è§„åˆ™å¿«é€Ÿå¯ç”¨/ç¦ç”¨åˆ‡æ¢

4. **èµ„æºæ³„æ¼æ£€æµ‹**
   - å†…å­˜æ³„æ¼æµ‹è¯•ï¼ˆé•¿æ—¶é—´è¿è¡Œï¼‰
   - Goroutine æ³„æ¼æ£€æµ‹
   - æ•°æ®åº“è¿æ¥æ³„æ¼
   - æ–‡ä»¶å¥æŸ„æ³„æ¼

**æµ‹è¯•å·¥å…·**:
- `pprof` - æ€§èƒ½åˆ†æå’Œå†…å­˜æ³„æ¼æ£€æµ‹
- `race detector` - å¹¶å‘ç«äº‰æ£€æµ‹
- `chaos-monkey` - æ•…éšœæ³¨å…¥

**æ‰§è¡Œå‘½ä»¤**:
```bash
# å¹¶å‘ç«äº‰æ£€æµ‹
go test -race ./internal/...

# å†…å­˜æ³„æ¼æ£€æµ‹
go test -memprofile=mem.prof ./internal/...
go tool pprof mem.prof
```

**åˆ›å»ºæ–‡ä»¶**: `tests/reliability/chaos_test.go`

---

### é˜¶æ®µå››ï¼šè‡ªåŠ¨åŒ–å’Œ CI/CDï¼ˆä¼˜å…ˆçº§ï¼šä¸­ ğŸŸ¡ï¼‰

#### ä»»åŠ¡ 7: å»ºç«‹ CI/CD æµ‹è¯•æµæ°´çº¿ ğŸŸ¡

**ä¼˜å…ˆçº§**: ä¸­  
**é¢„è®¡æ—¶é—´**: 0.5 å¤©

**åŠŸèƒ½éœ€æ±‚**:

1. **è‡ªåŠ¨åŒ–æµ‹è¯•æ‰§è¡Œ**
   - æ¯æ¬¡ push è§¦å‘å•å…ƒæµ‹è¯•
   - PR åˆå¹¶å‰å¼ºåˆ¶è¿è¡Œæµ‹è¯•
   - æµ‹è¯•å¤±è´¥é˜»æ­¢åˆå¹¶

2. **è¦†ç›–ç‡æŠ¥å‘Š**
   - è‡ªåŠ¨ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
   - è¦†ç›–ç‡è¶‹åŠ¿åˆ†æ
   - ä½äºé˜ˆå€¼ï¼ˆ60%ï¼‰æ—¶å‘Šè­¦

3. **å¤šç¯å¢ƒæµ‹è¯•**
   - Go 1.21, 1.22, 1.23 ç‰ˆæœ¬æµ‹è¯•
   - Linux, macOS ç¯å¢ƒæµ‹è¯•
   - MongoDB 6.0, 7.0 ç‰ˆæœ¬æµ‹è¯•

4. **æµ‹è¯•ç»“æœé€šçŸ¥**
   - æµ‹è¯•å¤±è´¥æ—¶å‘é€é€šçŸ¥
   - è¦†ç›–ç‡å˜åŒ–æŠ¥å‘Š
   - æ€§èƒ½å›å½’æ£€æµ‹

**åˆ›å»ºæ–‡ä»¶**:
```
.github/workflows/
â”œâ”€â”€ unit-tests.yml          # å•å…ƒæµ‹è¯•å·¥ä½œæµ
â”œâ”€â”€ integration-tests.yml   # é›†æˆæµ‹è¯•å·¥ä½œæµ
â”œâ”€â”€ performance-tests.yml   # æ€§èƒ½æµ‹è¯•å·¥ä½œæµï¼ˆæ‰‹åŠ¨è§¦å‘ï¼‰
â””â”€â”€ coverage-report.yml     # è¦†ç›–ç‡æŠ¥å‘Šå·¥ä½œæµ
```

**GitHub Actions ç¤ºä¾‹**:
```yaml
name: Unit Tests

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        go-version: [1.21, 1.22, 1.23]
    
    services:
      mongodb:
        image: mongo:6.0
        ports:
          - 27017:27017
    
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-go@v4
        with:
          go-version: ${{ matrix.go-version }}
      
      - name: Run tests
        run: ./run_unit_tests.sh
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          file: ./docs/testing/coverage/unit-coverage-all.out
```

---

### é˜¶æ®µäº”ï¼šæ–‡æ¡£å’Œå·¥å…·å®Œå–„ï¼ˆä¼˜å…ˆçº§ï¼šä½ ğŸŸ¢ï¼‰

#### ä»»åŠ¡ 8: å®Œå–„æµ‹è¯•æ–‡æ¡£ ğŸŸ¢

**ä¼˜å…ˆçº§**: ä½  
**é¢„è®¡æ—¶é—´**: 0.5 å¤©

**æ–‡æ¡£éœ€æ±‚**:

1. **æµ‹è¯•ç”¨ä¾‹æ–‡æ¡£**
   - å„æ¨¡å—æµ‹è¯•ç”¨ä¾‹æ¸…å•
   - æµ‹è¯•åœºæ™¯è¯´æ˜
   - é¢„æœŸç»“æœå®šä¹‰

2. **æµ‹è¯•æ•°æ®è¯´æ˜**
   - æ ‡å‡†æµ‹è¯•æ•°æ®é›†
   - æµ‹è¯•é¡¹ç›®/ç¯å¢ƒ/è§„åˆ™æ¨¡æ¿
   - è¾¹ç•Œå€¼å’Œå¼‚å¸¸å€¼å®šä¹‰

3. **Mock ä½¿ç”¨æŒ‡å—**
   - å¦‚ä½•ç¼–å†™ Mock æµ‹è¯•
   - testify/mock æœ€ä½³å®è·µ
   - å¸¸è§æµ‹è¯•æ¨¡å¼

4. **æµ‹è¯•ç»´æŠ¤æŒ‡å—**
   - å¦‚ä½•æ·»åŠ æ–°æµ‹è¯•
   - æµ‹è¯•æ•°æ®ç®¡ç†
   - æµ‹è¯•å¤±è´¥æ’æŸ¥æµç¨‹

**åˆ›å»ºæ–‡ä»¶**:
```
docs/testing/
â”œâ”€â”€ TESTING_GUIDE.md           # æµ‹è¯•æŒ‡å—æ€»è§ˆ
â”œâ”€â”€ TEST_DATA_GUIDE.md         # æµ‹è¯•æ•°æ®è¯´æ˜
â”œâ”€â”€ MOCK_PATTERNS.md           # Mock æ¨¡å¼å’Œæœ€ä½³å®è·µ
â””â”€â”€ TROUBLESHOOTING.md         # æµ‹è¯•é—®é¢˜æ’æŸ¥
```

---

#### ä»»åŠ¡ 9: é›†æˆæµ‹è¯•åˆ°ä¸»ç¨‹åº ğŸŸ¡

**ä¼˜å…ˆçº§**: ä¸­  
**é¢„è®¡æ—¶é—´**: 0.5 å¤©

**éªŒè¯å†…å®¹**:

1. **ä¸»ç¨‹åºå¯åŠ¨æµ‹è¯•**
   - `cmd/mockserver/main.go` æ­£å¸¸ç¼–è¯‘
   - æœåŠ¡æ­£å¸¸å¯åŠ¨
   - æ‰€æœ‰æ¨¡å—æ­£ç¡®åˆå§‹åŒ–
   - é…ç½®æ­£ç¡®åŠ è½½

2. **å®Œæ•´åŠŸèƒ½éªŒè¯**
   - ç®¡ç† API æœåŠ¡å¯åŠ¨ï¼ˆ8080ç«¯å£ï¼‰
   - Mock æœåŠ¡å¯åŠ¨ï¼ˆ9090ç«¯å£ï¼‰
   - æ•°æ®åº“è¿æ¥æˆåŠŸ
   - æ—¥å¿—æ­£å¸¸è¾“å‡º

3. **å¥åº·æ£€æŸ¥**
   - `/api/v1/system/health` è¿”å›æ­£å¸¸
   - `/api/v1/system/version` è¿”å›ç‰ˆæœ¬ä¿¡æ¯
   - ç³»ç»Ÿèµ„æºç›‘æ§æ­£å¸¸

**æµ‹è¯•æ–¹å¼**:
```bash
# ç¼–è¯‘ä¸»ç¨‹åº
go build -o mockserver ./cmd/mockserver

# å¯åŠ¨æœåŠ¡
./mockserver

# éªŒè¯å¥åº·æ£€æŸ¥
curl http://localhost:8080/api/v1/system/health

# ä½¿ç”¨ test.sh è¿›è¡Œå®Œæ•´éªŒè¯
./test.sh
```

**åˆ›å»ºæ–‡ä»¶**: `tests/smoke/smoke_test.sh`ï¼ˆå†’çƒŸæµ‹è¯•ï¼‰

---

#### ä»»åŠ¡ 10: ä¼˜åŒ– Docker æµ‹è¯•ç¯å¢ƒ ğŸŸ¢

**ä¼˜å…ˆçº§**: ä½  
**é¢„è®¡æ—¶é—´**: 0.5 å¤©

**åŠŸèƒ½éœ€æ±‚**:

1. **ä¸“é—¨çš„æµ‹è¯• Docker Compose**
   - ç‹¬ç«‹çš„æµ‹è¯•ç¯å¢ƒé…ç½®
   - å¿«é€Ÿå¯åŠ¨å’Œæ¸…ç†
   - è‡ªåŠ¨åˆå§‹åŒ–æµ‹è¯•æ•°æ®

2. **å¤šç¯å¢ƒæ”¯æŒ**
   - å¼€å‘æµ‹è¯•ç¯å¢ƒ
   - CI æµ‹è¯•ç¯å¢ƒ
   - æ€§èƒ½æµ‹è¯•ç¯å¢ƒ

3. **æµ‹è¯•è¾…åŠ©å·¥å…·**
   - è‡ªåŠ¨åˆ›å»ºæµ‹è¯•é¡¹ç›®å’Œç¯å¢ƒ
   - æµ‹è¯•æ•°æ®åˆå§‹åŒ–è„šæœ¬
   - å¿«é€Ÿæ¸…ç†æµ‹è¯•æ•°æ®

**åˆ›å»ºæ–‡ä»¶**:
```
docker/
â”œâ”€â”€ docker-compose.test.yml    # æµ‹è¯•ç¯å¢ƒé…ç½®
â”œâ”€â”€ docker-compose.perf.yml    # æ€§èƒ½æµ‹è¯•ç¯å¢ƒ
â””â”€â”€ init-test-data.sh          # æµ‹è¯•æ•°æ®åˆå§‹åŒ–
```

**æµ‹è¯•ç¯å¢ƒé…ç½®ç¤ºä¾‹**:
```yaml
version: '3.8'

services:
  mongodb-test:
    image: mongo:6.0
    container_name: mockserver-mongo-test
    ports:
      - "27018:27017"
    tmpfs:
      - /data/db  # ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼Œæµ‹è¯•æ›´å¿«
    
  mockserver-test:
    build: .
    container_name: mockserver-test
    depends_on:
      - mongodb-test
    environment:
      - MONGODB_URI=mongodb://mongodb-test:27017
    ports:
      - "8081:8080"
      - "9091:9090"
```

---

## ğŸ“ˆ æµ‹è¯•è¦†ç›–ç‡æå‡è·¯çº¿å›¾

```
å½“å‰çŠ¶æ€: 48.2%
    â†“
é˜¶æ®µä¸€å®Œæˆï¼ˆEngine + Executor + Configï¼‰: ~60%
    â†“
é›†æˆæµ‹è¯•è¡¥å……: ~65%
    â†“
å¯é æ€§æµ‹è¯•è¡¥å……: ~70%
    â†“
æœ€ç»ˆç›®æ ‡: 75%+
```

### åˆ†é˜¶æ®µç›®æ ‡

| é˜¶æ®µ | å®Œæˆä»»åŠ¡ | é¢„æœŸè¦†ç›–ç‡ | é¢„è®¡æ—¶é—´ |
|------|---------|-----------|---------|
| **é˜¶æ®µä¸€** | Engineã€Executorã€Config æµ‹è¯• | 60%+ | 1.5 å¤© |
| **é˜¶æ®µäºŒ** | é›†æˆæµ‹è¯•ã€æ€§èƒ½æµ‹è¯• | 65%+ | 1.5 å¤© |
| **é˜¶æ®µä¸‰** | å¯é æ€§æµ‹è¯• | 70%+ | 1 å¤© |
| **é˜¶æ®µå››** | CI/CD è‡ªåŠ¨åŒ– | 70%+ | 0.5 å¤© |
| **é˜¶æ®µäº”** | æ–‡æ¡£å’Œå·¥å…· | 75%+ | 1 å¤© |
| **æ€»è®¡** | - | **75%+** | **~6 å¤©** |

---

## ğŸ¯ å¿«é€Ÿè¡ŒåŠ¨å»ºè®®ï¼ˆæœ¬å‘¨å†…å®Œæˆï¼‰

### é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼ˆå¿…é¡»å®Œæˆï¼‰ğŸ”´

1. **æå‡ Engine æ¨¡å—æµ‹è¯•è¦†ç›–ç‡** (0.5å¤©)
   - æœ€å…³é”®çš„æ ¸å¿ƒåŒ¹é…é€»è¾‘
   - ä» 58% â†’ 80%+
   
2. **æ·»åŠ  Config æ¨¡å—æµ‹è¯•** (0.5å¤©)
   - å½“å‰å®Œå…¨æ²¡æœ‰æµ‹è¯•
   - é…ç½®é”™è¯¯ä¼šå¯¼è‡´ä¸¥é‡é—®é¢˜

3. **é›†æˆæµ‹è¯•åˆ°ä¸»ç¨‹åº** (0.5å¤©)
   - éªŒè¯æ•´ä½“åŠŸèƒ½å¯ç”¨æ€§
   - ä¸ºå‘å¸ƒåšå‡†å¤‡

### ä¸­ä¼˜å…ˆçº§ä»»åŠ¡ï¼ˆæ¨èå®Œæˆï¼‰ğŸŸ¡

4. **æå‡ Executor æ¨¡å—æµ‹è¯•** (0.5å¤©)
   - ä» 71.9% â†’ 85%+

5. **åˆ›å»ºç«¯åˆ°ç«¯æµ‹è¯•** (1å¤©)
   - éªŒè¯å®Œæ•´ä¸šåŠ¡æµç¨‹
   - æé«˜ç³»ç»Ÿå¯é æ€§

### ä½ä¼˜å…ˆçº§ä»»åŠ¡ï¼ˆå¯å»¶åï¼‰ğŸŸ¢

6. **æ€§èƒ½æµ‹è¯•** (0.5å¤©)
7. **CI/CD æµæ°´çº¿** (0.5å¤©)
8. **æµ‹è¯•æ–‡æ¡£** (0.5å¤©)

---

## ğŸ“‹ æ‰§è¡Œæ£€æŸ¥æ¸…å•

### ç¬¬ 1 å¤©
- [ ] æå‡ Engine æ¨¡å—æµ‹è¯•è¦†ç›–ç‡åˆ° 80%+
- [ ] æ·»åŠ  Config æ¨¡å—å•å…ƒæµ‹è¯•
- [ ] è¿è¡Œå®Œæ•´æµ‹è¯•ï¼ŒéªŒè¯è¦†ç›–ç‡è¾¾åˆ° 55%+

### ç¬¬ 2 å¤©
- [ ] æå‡ Executor æ¨¡å—æµ‹è¯•è¦†ç›–ç‡åˆ° 85%+
- [ ] é›†æˆæµ‹è¯•åˆ°ä¸»ç¨‹åºï¼ŒéªŒè¯å¯åŠ¨æ­£å¸¸
- [ ] è¿è¡Œå®Œæ•´æµ‹è¯•ï¼ŒéªŒè¯è¦†ç›–ç‡è¾¾åˆ° 60%+

### ç¬¬ 3 å¤©
- [ ] åˆ›å»ºç«¯åˆ°ç«¯é›†æˆæµ‹è¯•å¥—ä»¶
- [ ] æµ‹è¯•å®Œæ•´ä¸šåŠ¡æµç¨‹
- [ ] è¿è¡Œå®Œæ•´æµ‹è¯•ï¼ŒéªŒè¯è¦†ç›–ç‡è¾¾åˆ° 65%+

### ç¬¬ 4 å¤©
- [ ] å®æ–½æ€§èƒ½æµ‹è¯•
- [ ] éªŒè¯æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡ï¼ˆQPS >10,000ï¼‰
- [ ] è®°å½•æ€§èƒ½åŸºå‡†

### ç¬¬ 5 å¤©
- [ ] å¯é æ€§å’Œå¼‚å¸¸åœºæ™¯æµ‹è¯•
- [ ] å¹¶å‘ç«äº‰æ£€æµ‹
- [ ] å†…å­˜æ³„æ¼æ£€æµ‹

### ç¬¬ 6 å¤©
- [ ] å»ºç«‹ CI/CD æµ‹è¯•æµæ°´çº¿
- [ ] å®Œå–„æµ‹è¯•æ–‡æ¡£
- [ ] ä¼˜åŒ– Docker æµ‹è¯•ç¯å¢ƒ

---

## ğŸš€ ç«‹å³å¼€å§‹

### æ¨èçš„æ‰§è¡Œé¡ºåº

```bash
# 1. å…ˆå®Œæˆé«˜ä¼˜å…ˆçº§ä»»åŠ¡
cd /Users/huangzhonghui/aicoding/gomockserver

# 2. æå‡ Engine æ¨¡å—æµ‹è¯•
# ç¼–è¾‘ internal/engine/match_engine_test.go
# è¡¥å…… IP ç™½åå•ã€å¤æ‚æ¡ä»¶ã€è¾¹ç•Œåœºæ™¯æµ‹è¯•

# 3. æ·»åŠ  Config æ¨¡å—æµ‹è¯•
# åˆ›å»º internal/config/config_test.go
# æµ‹è¯•é…ç½®åŠ è½½ã€éªŒè¯ã€é»˜è®¤å€¼

# 4. è¿è¡Œæµ‹è¯•å¹¶æŸ¥çœ‹è¦†ç›–ç‡
./run_unit_tests.sh

# 5. éªŒè¯ä¸»ç¨‹åºé›†æˆ
go build -o mockserver ./cmd/mockserver
./mockserver

# 6. åˆ›å»ºç«¯åˆ°ç«¯æµ‹è¯•
mkdir -p tests/e2e
# åˆ›å»º tests/e2e/e2e_test.go
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [æµ‹è¯•æ–¹æ¡ˆè®¾è®¡æ–‡æ¡£](./plans/perfect-mvp-testing-plan.md)
- [å•å…ƒæµ‹è¯•æ‰§è¡Œæ€»ç»“](./UNIT_TEST_EXECUTION_SUMMARY.md)
- [è¦†ç›–ç‡åˆ†æå’Œæ”¹è¿›æ–¹æ¡ˆ](./COVERAGE_ANALYSIS_AND_IMPROVEMENT.md)
- [å•å…ƒæµ‹è¯•æŠ¥å‘Š](./UNIT_TEST_REPORT.md)
- [Go Testing å®˜æ–¹æ–‡æ¡£](https://golang.org/pkg/testing/)
- [Testify ä½¿ç”¨æŒ‡å—](https://github.com/stretchr/testify)

---

**æ–‡æ¡£ç»´æŠ¤**: éšç€ä»»åŠ¡å®Œæˆï¼Œè¯·åŠæ—¶æ›´æ–°æ­¤è·¯çº¿å›¾  
**æœ€åæ›´æ–°**: 2025-11-14  
**ç»´æŠ¤è€…**: Mock Server å¼€å‘å›¢é˜Ÿ
